# An optional list of operating system packages to install.
packages:
  - gcc

# An optional definition of a conda environment.
# Only the conda packages hosted in Artifactory by the Met Office are available.
# Must include a 'spec-file' and/or a 'packages' list.
# The environment will be created at /opt/env and placed on the PATH.
conda:
  # An optional list of Met Office channels in Artifactory.
  # Defaults to: conda-main, conda-forge, conda-mo-internal, conda-r
  channels:
    - conda-main
    - conda-mo-internal
  # To make a spec file from your current active environment environment use:
  #   conda list --explicit > spec-file.txt
  # For details on the Conda file formats see:
  # https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html
  spec-file: conda-spec-file.txt
#  packages:
#    - numpy=1.21
#    - pyepsg

# An optional list of shell commands to execute.
# These will be run in the conda environment if one has been defined.
# There is no access to the internet during this stage, so curl/wget commands will not work.
# During the build the contents of the source repo will exist at
# /opt/env-defn, but it will not exist in the final image.
# If some of the content needs to persist then it will need to be explicitly copied
# elsewhere, e.g. as a result of a make and/or install step.
commands:
  - echo 'Hello ...'
  - echo '... world!'
  - cd /opt/env-defn
  - python setup.py install

# An optional list of name-value pairs that will be added as metadata to the image.
# They can be extracted from the resulting image with:
#   singularity inspect <image>
labels:
  owner: byron.blay@metoffice.gov.uk
  version: 0.0.1

# An optional command to execute when the image is run.
run: echo "That's all, folks!"
